<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
	<xsl:output method="text" encoding="iso-8859-1"/>

<!--
CSV header (first line containing the column titles):
NETBIOS, QID, STATUS, SEVERITY, CVE, TITLE

Input file generated by curl -H 'X-Requested-With: curl' -u 'LOGIN:PASS' 'https://qualysapi.qualys.com/api/2.0/fo/asset/host/vm/detection/?action=list&show_igs=1' > detection.xml

xsltproc detection2csv.xsl detection.xml > detection-full.csv

the variable merge_with is the filename of the XML output of Qualys knowledgebase_download.php
-->

	<xsl:param name="delim" select="string(',')" />
	<xsl:param name="quote" select="string('&quot;')" />
	<xsl:param name="break" select="string('&#xD;')" />
	<xsl:param name="linefeed" select="string('&#10;')" />
	<xsl:param name="space" select="string('&#x20;')" />


	<xsl:template match="/">
		<xsl:text>"NETBIOS","QID","STATUS","LAST_FOUND","SEVERITY","CVE","TITLE"</xsl:text>
		<xsl:value-of select="$linefeed"/>
		<xsl:apply-templates select="HOST_LIST_VM_DETECTION_OUTPUT/RESPONSE/HOST_LIST/HOST/DETECTION_LIST/DETECTION"/>
	</xsl:template>

	<xsl:template match="DETECTION">

		<xsl:variable name="cur" select="current()" />
	
		<xsl:variable name="vuln"
